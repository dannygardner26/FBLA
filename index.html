<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Great Valley Job Board</title>
    <style>
        :root {
            --primary: #283593;
            --background: #f5f7fb;
            --card-bg: white;
            --text: #333;
            --text-secondary: #666;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: system-ui, -apple-system, sans-serif;
        }

        body {
            background: var(--background);
            min-height: 100vh;
        }

        .nav {
            background: var(--primary);
            color: white;
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .nav-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .logo img {
            height: 40px;
            width: 40px;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 0.5rem;
            cursor: pointer;
        }

        .container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .header-section {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            align-items: center;
        }

        .search-container {
            flex: 1;
            background: white;
            border-radius: 8px;
            padding: 0.75rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
        }

        .search-input {
            border: none;
            outline: none;
            font-size: 1rem;
            width: 100%;
            padding: 0.5rem;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .job-card {
            background: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .job-title {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .job-meta {
            color: var(--text-secondary);
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
        }

        .btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            width: 90%;
            max-width: 600px;
            margin: 2rem auto;
            position: relative;
            max-height: 90vh;
            overflow-y: auto;
        }

        .close {
            position: absolute;
            right: 1rem;
            top: 1rem;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }

        .toast {
            position: fixed;
            bottom: 1rem;
            right: 1rem;
            padding: 1rem 2rem;
            border-radius: 4px;
            color: white;
            background: #4caf50;
            display: none;
            z-index: 2000;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .toast.error {
            background: #f44336;
        }

        .toast.feedback {
            background: #2196f3;
        }

        .required {
            color: #f44336;
        }

        .application-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            background: white;
        }

        .application-card .status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            margin-bottom: 1rem;
        }

        .status.pending {
            background: #fff3cd;
            color: #856404;
        }

        .status.approved {
            background: #d4edda;
            color: #155724;
        }

        .status.rejected {
            background: #f8d7da;
            color: #721c24;
        }

        .application-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .btn.approve {
            background: #28a745;
        }

        .btn.reject {
            background: #dc3545;
        }

        @media (max-width: 768px) {
            .header-section {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }

            .nav-links {
                gap: 0.5rem;
            }
        }
    </style>
</head>

<body>
    <nav class="nav">
        <div class="nav-content">
            <a href="#" class="nav-link">Great Valley Job Board</a>
            <div class="nav-links">
                <a href="#" class="nav-link" id="adminLink" style="display:none;">Admin Panel</a>
                <a href="#" class="nav-link" id="loginLink">Login</a>
                <a href="#" class="nav-link" id="registerLink">Register</a>
            </div>
        </div>
    </nav>

    <main class="container">
        <div class="header-section">
            <div class="search-container">
                <input type="text" id="searchInput" class="search-input" placeholder="Search jobs...">
            </div>
            <button id="createJobBtn" class="btn" style="display:none;">Post New Job</button>
        </div>

        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-number" id="activeJobsCount">0</div>
                <div>Active Jobs</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="companiesCount">0</div>
                <div>Companies</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="applicationsCount">0</div>
                <div>Applications</div>
            </div>
        </div>

        <div id="jobListings"></div>
    </main>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" name="username" required>
                </div>
                <div class="form-group">
                    <label>Password</label>
                    <input type="password" name="password" required>
                </div>
                <button type="submit" class="btn">Login</button>
            </form>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Register</h2>
            <div class="form-group">
                <label>Register as:</label>
                <select id="roleSelect" required>
                    <option value="">Select role...</option>
                    <option value="student">Student</option>
                    <option value="employer">Employer</option>
                </select>
            </div>
            <form id="registerForm">
                <div id="commonFields">
                    <div class="form-group">
                        <label>Username</label>
                        <input type="text" name="username" required>
                    </div>
                    <div class="form-group">
                        <label>Password</label>
                        <input type="password" name="password" required>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" name="email" required>
                    </div>
                </div>
                <div id="studentFields" style="display:none;">
                    <div class="form-group">
                        <label>Full Name</label>
                        <input type="text" name="fullName">
                    </div>
                    <div class="form-group">
                        <label>Grade Level</label>
                        <input type="text" name="gradeLevel">
                    </div>
                </div>
                <div id="employerFields" style="display:none;">
                    <div class="form-group">
                        <label>Company Name</label>
                        <input type="text" name="companyName">
                    </div>
                    <div class="form-group">
                        <label>Company Website</label>
                        <input type="url" name="website">
                    </div>
                </div>
                <button type="submit" class="btn">Register</button>
            </form>
        </div>
    </div>

    <!-- Post Job Modal -->
    <div id="postJobModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Post New Job</h2>
            <form id="postJobForm">
                <div class="form-group">
                    <label>Job Title <span class="required">*</span></label>
                    <input type="text" name="title" required>
                </div>
                <div class="form-group">
                    <label>Job Type <span class="required">*</span></label>
                    <select name="jobType" required>
                        <option value="">Select type...</option>
                        <option value="Full-time">Full-time</option>
                        <option value="Part-time">Part-time</option>
                        <option value="Internship">Internship</option>
                        <option value="Temporary">Temporary</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Department</label>
                    <input type="text" name="department">
                </div>
                <div class="form-group">
                    <label>Location <span class="required">*</span></label>
                    <input type="text" name="location" required>
                </div>
                <div class="form-group">
                    <label>Salary Range</label>
                    <div style="display: flex; gap: 1rem;">
                        <input type="number" name="salaryMin" placeholder="Minimum">
                        <input type="number" name="salaryMax" placeholder="Maximum">
                    </div>
                </div>
                <div class="form-group">
                    <label>Description <span class="required">*</span></label>
                    <textarea name="description" rows="4" required></textarea>
                </div>
                <div class="form-group">
                    <label>Requirements <span class="required">*</span></label>
                    <textarea name="requirements" rows="4" required
                        placeholder="List key requirements, one per line"></textarea>
                </div>
                <div class="form-group">
                    <label>Benefits</label>
                    <textarea name="benefits" rows="3" placeholder="List benefits, one per line"></textarea>
                </div>
                <div class="form-group">
                    <label>Application Deadline</label>
                    <input type="date" name="deadline">
                </div>
                <button type="submit" class="btn">Submit Job Posting</button>
            </form>
        </div>
    </div>

    <!-- Apply Modal -->
    <div id="applyModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Apply for Position</h2>
            <form id="applyForm">
                <div class="form-group">
                    <label>Full Name <span class="required">*</span></label>
                    <input type="text" name="fullName" required>
                </div>
                <div class="form-group">
                    <label>Email <span class="required">*</span></label>
                    <input type="email" name="email" required>
                </div>
                <div class="form-group">
                    <label>Phone <span class="required">*</span></label>
                    <input type="tel" name="phone" required>
                </div>
                <div class="form-group">
                    <label>Current Grade Level <span class="required">*</span></label>
                    <select name="gradeLevel" required>
                        <option value="">Select grade...</option>
                        <option value="9">9th Grade</option>
                        <option value="10">10th Grade</option>
                        <option value="11">11th Grade</option>
                        <option value="12">12th Grade</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>GPA</label>
                    <input type="number" name="gpa" step="0.01" min="0" max="4">
                </div>
                <div class="form-group">
                    <label>Relevant Coursework</label>
                    <textarea name="coursework" rows="3" placeholder="List relevant courses you've taken"></textarea>
                </div>
                <div class="form-group">
                    <label>Experience</label>
                    <textarea name="experience" rows="4"
                        placeholder="Describe any relevant experience, including clubs, volunteer work, or previous jobs"></textarea>
                </div>
                <div class="form-group">
                    <label>Skills</label>
                    <textarea name="skills" rows="3" placeholder="List your relevant skills"></textarea>
                </div>
                <div class="form-group">
                    <label>Cover Letter <span class="required">*</span></label>
                    <textarea name="coverLetter" rows="6" required
                        placeholder="Why are you interested in this position? What makes you a good fit?"></textarea>
                </div>
                <div class="form-group">
                    <label>References</label>
                    <textarea name="references" rows="3"
                        placeholder="List any references with their contact information"></textarea>
                </div>
                <button type="submit" class="btn">Submit Application</button>
            </form>
        </div>
    </div>

    <!-- Admin Modal -->
    <div id="adminModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Admin Panel</h2>
            <div id="pendingJobs"></div>
        </div>
    </div>

    <!-- Manage Applications Modal -->
    <div id="manageApplicationsModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Manage Applications</h2>
            <div id="applicationsContainer"></div>
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script>
        // Storage Configuration
        const STORAGE_KEYS = {
            JOBS: 'jobs',
            USERS: 'users',
            APPLICATIONS: 'applications',
            CURRENT_USER: 'currentUser'
        };

        // Initialize default data
        function initializeStorage() {
            if (!localStorage.getItem(STORAGE_KEYS.JOBS)) {
                localStorage.setItem(STORAGE_KEYS.JOBS, JSON.stringify([]));
            }
            if (!localStorage.getItem(STORAGE_KEYS.USERS)) {
                localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify([{
                    id: 'admin1',
                    username: 'admin',
                    password: 'admin123',
                    role: 'admin'
                }]));
            }
            if (!localStorage.getItem(STORAGE_KEYS.APPLICATIONS)) {
                localStorage.setItem(STORAGE_KEYS.APPLICATIONS, JSON.stringify([]));
            }
        }

        // Utility Functions
        function getData(key) {
            return JSON.parse(localStorage.getItem(key)) || [];
        }

        function saveData(key, data) {
            localStorage.setItem(key, JSON.stringify(data));
        }

        function showToast(message, isError = false) {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${isError ? 'error' : ''}`;
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
            }, 3000);
        }

        // Modal Management
        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }

        document.querySelectorAll('.modal .close').forEach(closeBtn => {
            closeBtn.onclick = () => closeBtn.closest('.modal').style.display = 'none';
        });

        window.onclick = (event) => {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        };

        // Authentication
        document.getElementById('loginLink').onclick = () => {
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            if (currentUser) {
                localStorage.removeItem(STORAGE_KEYS.CURRENT_USER);
                updateUIForUser(null);
                showToast('Logged out successfully');
                return;
            }
            document.getElementById('loginModal').style.display = 'block';
        };

        document.getElementById('loginForm').onsubmit = (e) => {
            e.preventDefault();
            const formData = new FormData(e.target);
            const username = formData.get('username');
            const password = formData.get('password');

            const users = getData(STORAGE_KEYS.USERS);
            const user = users.find(u => u.username === username && u.password === password);

            if (user) {
                localStorage.setItem(STORAGE_KEYS.CURRENT_USER, JSON.stringify(user));
                closeAllModals();
                e.target.reset();
                updateUIForUser(user);
                showToast('Logged in successfully');
                renderJobs();
            } else {
                showToast('Invalid credentials', true);
            }
        };

        // Registration
        document.getElementById('registerLink').onclick = () => {
            document.getElementById('registerModal').style.display = 'block';
        };

        document.getElementById('roleSelect').onchange = (e) => {
            const studentFields = document.getElementById('studentFields');
            const employerFields = document.getElementById('employerFields');

            studentFields.style.display = e.target.value === 'student' ? 'block' : 'none';
            employerFields.style.display = e.target.value === 'employer' ? 'block' : 'none';
        };

        document.getElementById('registerForm').onsubmit = (e) => {
            e.preventDefault();
            const role = document.getElementById('roleSelect').value;
            if (!role) {
                showToast('Please select a role', true);
                return;
            }

            const formData = new FormData(e.target);
            const userData = {
                id: Date.now().toString(),
                username: formData.get('username'),
                password: formData.get('password'),
                email: formData.get('email'),
                role: role
            };

            if (role === 'student') {
                userData.fullName = formData.get('fullName');
                userData.gradeLevel = formData.get('gradeLevel');
            } else {
                userData.companyName = formData.get('companyName');
                userData.website = formData.get('website');
            }

            const users = getData(STORAGE_KEYS.USERS);
            if (users.some(user => user.username === userData.username)) {
                showToast('Username already exists', true);
                return;
            }

            users.push(userData);
            saveData(STORAGE_KEYS.USERS, users);
            localStorage.setItem(STORAGE_KEYS.CURRENT_USER, JSON.stringify(userData));

            closeAllModals();
            e.target.reset();
            document.getElementById('roleSelect').value = '';
            document.getElementById('studentFields').style.display = 'none';
            document.getElementById('employerFields').style.display = 'none';
            updateUIForUser(userData);
            showToast('Registration successful!');
        };

        // Job Management
        document.getElementById('createJobBtn').onclick = () => {
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            if (!currentUser || currentUser.role !== 'employer') {
                showToast('Please login as an employer to post jobs', true);
                return;
            }
            document.getElementById('postJobModal').style.display = 'block';
        };

        document.getElementById('postJobForm').onsubmit = (e) => {
            e.preventDefault();
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            const formData = new FormData(e.target);

            const jobData = {
                id: Date.now().toString(),
                employerId: currentUser.id,
                company: currentUser.companyName,
                title: formData.get('title'),
                jobType: formData.get('jobType'),
                department: formData.get('department'),
                location: formData.get('location'),
                salaryRange: {
                    min: formData.get('salaryMin'),
                    max: formData.get('salaryMax')
                },
                description: formData.get('description'),
                requirements: formData.get('requirements'),
                benefits: formData.get('benefits'),
                deadline: formData.get('deadline'),
                status: 'pending',
                createdAt: new Date().toISOString()
            };

            const jobs = getData(STORAGE_KEYS.JOBS);
            jobs.push(jobData);
            saveData(STORAGE_KEYS.JOBS, jobs);

            closeAllModals();
            e.target.reset();
            showToast('Job posted successfully! Waiting for admin approval');
            renderJobs();
            updateStats();
        };

        // Admin Functionality
        document.getElementById('adminLink').onclick = () => {
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            if (!currentUser || currentUser.role !== 'admin') {
                showToast('Admin access only', true);
                return;
            }

            renderPendingJobs();
            document.getElementById('adminModal').style.display = 'block';
        };

        function renderPendingJobs() {
            const pendingJobs = getData(STORAGE_KEYS.JOBS).filter(job => job.status === 'pending');
            const container = document.getElementById('pendingJobs');

            container.innerHTML = pendingJobs.length === 0 ? '<p>No pending jobs</p>' :
                pendingJobs.map(job => ` 
                    <div class="job-card">
                        <h3>${job.title}</h3>
                        <p><strong>Company:</strong> ${job.company}</p>
                        <p>${job.description}</p>
                        <div class="job-meta">${new Date(job.createdAt).toLocaleDateString()}</div>
                        <div style="display: flex; gap: 1rem; margin-top: 1rem;">
                            <button onclick="approveJob('${job.id}')" class="btn">Approve</button>
                            <button onclick="rejectJob('${job.id}')"
                                class="btn" style="background: #f44336;">Reject</button>
                        </div>
                    </div>
                `).join('');
        }

        // Job Actions
        window.approveJob = (jobId) => {
            const jobs = getData(STORAGE_KEYS.JOBS);
            const jobIndex = jobs.findIndex(job => job.id === jobId);
            if (jobIndex !== -1) {
                jobs[jobIndex].status = 'approved';
                saveData(STORAGE_KEYS.JOBS, jobs);
                renderPendingJobs();
                renderJobs();
                updateStats();
                showToast('Job approved');
            }
        };

        window.rejectJob = (jobId) => {
            const jobs = getData(STORAGE_KEYS.JOBS);
            const jobIndex = jobs.findIndex(job => job.id === jobId);
            if (jobIndex !== -1) {
                jobs[jobIndex].status = 'rejected';
                saveData(STORAGE_KEYS.JOBS, jobs);
                renderPendingJobs();
                renderJobs();
                updateStats();
                showToast('Job rejected');
            }
        };

        // Job Search and Display
        document.getElementById('searchInput').oninput = (e) => {
            const searchTerm = e.target.value.toLowerCase();
            const jobs = getData(STORAGE_KEYS.JOBS)
                .filter(job => job.status === 'approved')
                .filter(job =>
                    job.title.toLowerCase().includes(searchTerm) ||
                    job.company.toLowerCase().includes(searchTerm) ||
                    job.description.toLowerCase().includes(searchTerm)
                );

            renderJobs(jobs);
        };

        function renderJobs(jobsToDisplay) {
            const jobs = jobsToDisplay || getData(STORAGE_KEYS.JOBS).filter(job => job.status === 'approved');
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            const container = document.getElementById('jobListings');

            container.innerHTML = jobs.length === 0 ? '<p>No jobs found</p>' :
                jobs.map(job => `
                    <div class="job-card">
                        <h3 class="job-title">${job.title}</h3>
                        <div class="job-meta">
                            <span>${job.company}</span>
                            <span>${new Date(job.createdAt).toLocaleDateString()}</span>
                        </div>
                        <p>${job.description}</p>
                        <div class="job-requirements">
                            <h4>Requirements:</h4>
                            <p>${job.requirements}</p>
                        </div>
                        ${currentUser && currentUser.role === 'student' ?
                        `<button onclick="showApplyForm('${job.id}')" class="btn">Apply Now</button>` : ''}
                        ${currentUser && currentUser.role === 'employer' && job.employerId === currentUser.id ?
                        `<button onclick="showApplications('${job.id}')" class="btn">View Applications (${getApplicationCount(job.id)})</button>` : ''}
                    </div>
                `).join('');
        }

        // Application System
        window.showApplyForm = (jobId) => {
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            if (!currentUser || currentUser.role !== 'student') {
                showToast('Please login as a student to apply', true);
                return;
            }

            const applyModal = document.getElementById('applyModal');
            applyModal.dataset.jobId = jobId;
            applyModal.style.display = 'block';
        };

        document.getElementById('applyForm').onsubmit = (e) => {
            e.preventDefault();
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            const jobId = e.target.closest('.modal').dataset.jobId;
            const formData = new FormData(e.target);

            const applicationData = {
                id: Date.now().toString(),
                jobId: jobId,
                userId: currentUser.id,
                fullName: formData.get('fullName'),
                email: formData.get('email'),
                phone: formData.get('phone'),
                gradeLevel: formData.get('gradeLevel'),
                gpa: formData.get('gpa'),
                coursework: formData.get('coursework'),
                experience: formData.get('experience'),
                skills: formData.get('skills'),
                coverLetter: formData.get('coverLetter'),
                references: formData.get('references'),
                status: 'PENDING',
                submittedAt: new Date().toISOString()
            };

            const applications = getData(STORAGE_KEYS.APPLICATIONS);
            applications.push(applicationData);
            saveData(STORAGE_KEYS.APPLICATIONS, applications);

            closeAllModals();
            e.target.reset();
            showToast('Application submitted successfully');
            updateStats();
        };

        // Application Management
        function getApplicationCount(jobId) {
            return getData(STORAGE_KEYS.APPLICATIONS)
                .filter(app => app.jobId === jobId).length;
        }

        window.showApplications = (jobId) => {
            const applications = getData(STORAGE_KEYS.APPLICATIONS)
                .filter(app => app.jobId === jobId);
            const container = document.getElementById('applicationsContainer');
            const modal = document.getElementById('manageApplicationsModal');

            container.innerHTML = applications.length === 0 ?
                '<p>No applications yet</p>' :
                applications.map(app => `
                    <div class="application-card">
                        <span class="status ${app.status.toLowerCase()}">${app.status}</span>
                        <h3>${app.fullName}</h3>
                        <div>
                            <strong>Email:</strong> ${app.email}<br>
                            <strong>Phone:</strong> ${app.phone}<br>
                            <strong>Grade Level:</strong> ${app.gradeLevel}<br>
                            ${app.gpa ? `<strong>GPA:</strong> ${app.gpa}<br>` : ''}
                        </div>
                        
                        <div style="margin: 1rem 0">
                            <strong>Cover Letter:</strong>
                            <p>${app.coverLetter}</p>
                        </div>
                        
                        ${app.experience ? `
                            <div style="margin: 1rem 0">
                                <strong>Experience:</strong>
                                <p>${app.experience}</p>
                            </div>
                        ` : ''}
                        
                        ${app.coursework ? `
                            <div style="margin: 1rem 0">
                                <strong>Relevant Coursework:</strong>
                                <p>${app.coursework}</p>
                            </div>
                        ` : ''}
                        
                        ${app.skills ? `
                            <div style="margin: 1rem 0">
                                <strong>Skills:</strong>
                                <p>${app.skills}</p>
                            </div>
                        ` : ''}

                        ${app.references ? `
                            <div style="margin: 1rem 0">
                                <strong>References:</strong>
                                <p>${app.references}</p>
                            </div>
                        ` : ''}

                        <div style="margin-top: 0.5rem; font-size: 0.875rem; color: var(--text-secondary);">
                            Submitted: ${new Date(app.submittedAt).toLocaleString()}
                        </div>

                        ${app.status === 'PENDING' ? `
                            <div class="application-actions">
                                <button onclick="handleApplication('${app.id}', 'APPROVED')" 
                                    class="btn approve">Approve</button>
                                <button onclick="handleApplication('${app.id}', 'REJECTED')" 
                                    class="btn reject">Reject</button>
                            </div>
                        ` : ''}
                    </div>
                `).join('');

            modal.style.display = 'block';
        };

        window.handleApplication = (applicationId, status) => {
            const applications = getData(STORAGE_KEYS.APPLICATIONS);
            const index = applications.findIndex(app => app.id === applicationId);

            if (index !== -1) {
                applications[index].status = status;
                applications[index].updatedAt = new Date().toISOString();

                saveData(STORAGE_KEYS.APPLICATIONS, applications);
                showApplications(applications[index].jobId);
                showToast(`Application ${status.toLowerCase()}`);
            }
        };

        // Stats Management
        function updateStats() {
            const jobs = getData(STORAGE_KEYS.JOBS);
            const applications = getData(STORAGE_KEYS.APPLICATIONS);

            document.getElementById('activeJobsCount').textContent =
                jobs.filter(job => job.status === 'approved').length;

            document.getElementById('companiesCount').textContent =
                [...new Set(jobs.filter(job => job.status === 'approved')
                    .map(job => job.company))].length;

            document.getElementById('applicationsCount').textContent = applications.length;
        }

        // UI State Management
        function updateUIForUser(user) {
            const adminLink = document.getElementById('adminLink');
            const createJobBtn = document.getElementById('createJobBtn');
            const loginLink = document.getElementById('loginLink');
            const registerLink = document.getElementById('registerLink');

            if (user) {
                loginLink.textContent = 'Logout';
                registerLink.style.display = 'none';
                adminLink.style.display = user.role === 'admin' ? 'block' : 'none';
                createJobBtn.style.display = user.role === 'employer' ? 'block' : 'none';
            } else {
                loginLink.textContent = 'Login';
                registerLink.style.display = 'block';
                adminLink.style.display = 'none';
                createJobBtn.style.display = 'none';
            }
        }

        // Initialize Application
        function initializeApp() {
            initializeStorage();
            const currentUser = JSON.parse(localStorage.getItem(STORAGE_KEYS.CURRENT_USER));
            updateUIForUser(currentUser);
            renderJobs();
            updateStats();
        }

        // Start the application
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>

</html>